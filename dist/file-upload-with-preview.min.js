var FileUploadWithPreview=function(){"use strict";Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),i=t.length;--i>=0&&t.item(i)!==this;);return i>-1}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var s=arguments[1],n=0;n<i;){var a=t[n];if(e.call(s,a,n,t))return n;n++}return-1},configurable:!0,writable:!0}),function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}e.prototype=window.Event.prototype,window.CustomEvent=e}();var e=function(e,t){if(!e)throw new Error("No uploadId found. You must initialize file-upload-with-preview with a unique uploadId.");if(this.uploadId=e,this.options=t||{},this.options.showDeleteButtonOnImages=!this.options.hasOwnProperty("showDeleteButtonOnImages")||this.options.showDeleteButtonOnImages,this.options.text=this.options.hasOwnProperty("text")?this.options.text:{chooseFile:"Choose file..."},this.options.text.chooseFile=this.options.text.hasOwnProperty("chooseFile")?this.options.text.chooseFile:"Choose file...",this.options.text.browse=this.options.text.hasOwnProperty("browse")?this.options.text.browse:"Browse",this.cachedFileArray=[],this.selectedFilesCount=0,this.el=document.querySelector('.custom-file-container[data-upload-id="'+this.uploadId+'"]'),!this.el)throw new Error("Could not find a 'custom-file-container' with the id of: "+this.uploadId);if(this.input=this.el.querySelector('input[type="file"]'),this.inputLabel=this.el.querySelector(".custom-file-container__custom-file__custom-file-control"),this.imagePreview=this.el.querySelector(".custom-file-container__image-preview"),this.clearButton=this.el.querySelector(".custom-file-container__image-clear"),this.inputLabel.innerHTML=this.options.text.chooseFile,this.addBrowseButton(this.options.text.browse),!(this.el&&this.input&&this.inputLabel&&this.imagePreview&&this.clearButton))throw new Error("Cannot find all necessary elements. Please make sure you have all the necessary elements in your html for the id: "+this.uploadId);this.options.images=this.options.hasOwnProperty("images")?this.options.images:{},this.baseImage=this.options.images.hasOwnProperty("baseImage")?this.options.images.baseImage:"./src/assets/images/base-image.svg",this.successPdfImage=this.options.images.hasOwnProperty("successPdfImage")?this.options.images.successPdfImage:"./src/assets/images/pdf-success.svg",this.successVideoImage=this.options.images.hasOwnProperty("successVideoImage")?this.options.images.successVideoImage:"./src/assets/images/video-success.svg",this.successFileAltImage=this.options.images.hasOwnProperty("successFileAltImage")?this.options.images.successFileAltImage:"./src/assets/images/file-alt-success.svg",this.backgroundImage=this.options.images.hasOwnProperty("backgroundImage")?this.options.images.backgroundImage:"./src/assets/images/background.svg",this.bindClickEvents(),this.imagePreview.style.backgroundImage='url("'+this.baseImage+'")'};return e.prototype.bindClickEvents=function(){var e=this,t=this;t.input.addEventListener("change",function(){if(0!==this.files.length){t.input.multiple?t.selectedFilesCount+=this.files.length:(t.selectedFilesCount=this.files.length,t.cachedFileArray=[]);for(var e=0;e<this.files.length;e++){var i=this.files[e];i.token=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),t.cachedFileArray.push(i),t.processFile(i)}var s=new CustomEvent("fileUploadWithPreview:imageSelected",{detail:{uploadId:t.uploadId,cachedFileArray:t.cachedFileArray,selectedFilesCount:t.selectedFilesCount}});window.dispatchEvent(s)}},!0),this.clearButton.addEventListener("click",function(){e.clearImagePreviewPanel()},!0),this.imagePreview.addEventListener("click",function(t){if(t.target.matches(".custom-file-container__image-multi-preview__single-image-clear__icon")){var i=t.target.getAttribute("data-upload-token"),s=e.cachedFileArray.findIndex(function(e){return e.token===i});e.deleteImageAtIndex(s)}})},e.prototype.deleteImageAtIndex=function(e){this.cachedFileArray[e]||console.log("There is no file at index",e),this.cachedFileArray.splice(e,1),this.resetImagePreviewPanel(),this.cachedFileArray.length||this.clearImagePreviewPanel();var t=new CustomEvent("fileUploadWithPreview:imageDeleted",{detail:{uploadId:this.uploadId,cachedFileArray:this.cachedFileArray,selectedFilesCount:this.selectedFilesCount}});window.dispatchEvent(t)},e.prototype.resetImagePreviewPanel=function(){var e=this;this.imagePreview.innerHTML="",this.selectedFilesCount=this.cachedFileArray.length,this.cachedFileArray.forEach(function(t){return e.processFile(t)})},e.prototype.processFile=function(e){var t=this;0===this.selectedFilesCount?this.inputLabel.innerHTML=this.options.text.chooseFile:1===this.selectedFilesCount?this.inputLabel.innerHTML=e.name:this.inputLabel.innerHTML=this.selectedFilesCount+" files selected",this.addBrowseButton(this.options.text.browse),this.imagePreview.classList.add("custom-file-container__image-preview--active");var i=new FileReader;i.readAsDataURL(e),i.onload=function(){t.input.multiple||(e.type.match("image/png")||e.type.match("image/jpeg")||e.type.match("image/gif")?t.imagePreview.style.backgroundImage='url("'+i.result+'")':e.type.match("application/pdf")?t.imagePreview.style.backgroundImage='url("'+t.successPdfImage+'")':e.type.match("video/*")?t.imagePreview.style.backgroundImage='url("'+t.successVideoImage+'")':t.imagePreview.style.backgroundImage='url("'+t.successFileAltImage+'")'),t.input.multiple&&(t.imagePreview.style.backgroundImage='url("'+t.backgroundImage+'")',e.type.match("image/png")||e.type.match("image/jpeg")||e.type.match("image/gif")?t.options.showDeleteButtonOnImages?t.imagePreview.innerHTML+='\n                            <div>\n                                <span\n                                    class="custom-file-container__image-multi-preview"\n                                    style="background-image: url(\''+i.result+'\'); "\n                                >\n                                    <span class="custom-file-container__image-multi-preview__single-image-clear">\n                                        <span\n                                            class="custom-file-container__image-multi-preview__single-image-clear__icon"\n                                            data-upload-token="'+e.token+'"\n                                        >&times;</span>\n                                    </span>\n                                </span>\n\n                            </div>\n                        ':t.imagePreview.innerHTML+='\n                            <div>\n                                <span\n                                    class="custom-file-container__image-multi-preview"\n                                    style="background-image: url(\''+i.result+"'); \"\n                                ></span>\n                            </div>\n                        ":e.type.match("application/pdf")?t.options.showDeleteButtonOnImages?t.imagePreview.innerHTML+='\n                            <div>\n                                <span\n                                    class="custom-file-container__image-multi-preview"\n                                    style="background-image: url(\''+t.successPdfImage+'\'); "\n                                >\n                                    <span class="custom-file-container__image-multi-preview__single-image-clear">\n                                        <span\n                                            class="custom-file-container__image-multi-preview__single-image-clear__icon"\n                                            data-upload-token="'+e.token+'"\n                                        >&times;</span>\n                                    </span>\n                                </span>\n\n                            </div>\n                        ':t.imagePreview.innerHTML+='\n                            <div>\n                                <span\n                                    class="custom-file-container__image-multi-preview"\n                                    style="background-image: url(\''+t.successPdfImage+"'); \"\n                                ></span>\n                            </div>\n                        ":e.type.match("video/*")?t.options.showDeleteButtonOnImages?t.imagePreview.innerHTML+='\n                            <div>\n                                <span\n                                    class="custom-file-container__image-multi-preview"\n                                    style="background-image: url(\''+t.successVideoImage+'\'); "\n                                >\n                                    <span class="custom-file-container__image-multi-preview__single-image-clear">\n                                        <span\n                                            class="custom-file-container__image-multi-preview__single-image-clear__icon"\n                                            data-upload-token="'+e.token+'"\n                                        >&times;</span>\n                                    </span>\n                                </span>\n\n                            </div>\n                        ':t.imagePreview.innerHTML+='\n                            <div>\n                                <span\n                                    class="custom-file-container__image-multi-preview"\n                                    style="background-image: url(\''+t.successVideoImage+"'); \"\n                                ></span>\n                            </div>\n                        ":t.options.showDeleteButtonOnImages?t.imagePreview.innerHTML+='\n                            <div>\n                                <span\n                                    class="custom-file-container__image-multi-preview"\n                                    style="background-image: url(\''+t.successFileAltImage+'\'); "\n                                >\n                                    <span class="custom-file-container__image-multi-preview__single-image-clear">\n                                        <span\n                                            class="custom-file-container__image-multi-preview__single-image-clear__icon"\n                                            data-upload-token="'+e.token+'"\n                                        >&times;</span>\n                                    </span>\n                                </span>\n\n                            </div>\n                        ':t.imagePreview.innerHTML+='\n                            <div>\n                                <span\n                                    class="custom-file-container__image-multi-preview"\n                                    style="background-image: url(\''+t.successFileAltImage+"'); \"\n                                ></span>\n                            </div>\n                        ")}},e.prototype.addBrowseButton=function(e){this.inputLabel.innerHTML+='<span class="custom-file-container__custom-file__custom-file-control__button"> '+e+" </span>"},e.prototype.selectImage=function(){this.input.click()},e.prototype.clearImagePreviewPanel=function(){this.input.value="",this.inputLabel.innerHTML=this.options.text.chooseFile,this.addBrowseButton(this.options.text.browse),this.imagePreview.style.backgroundImage='url("'+this.baseImage+'")',this.imagePreview.classList.remove("custom-file-container__image-preview--active"),this.cachedFileArray=[],this.imagePreview.innerHTML="",this.selectedFilesCount=0},e}();
